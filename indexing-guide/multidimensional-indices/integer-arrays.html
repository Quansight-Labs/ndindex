<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Boolean Array Indices" href="boolean-arrays.html" /><link rel="prev" title="newaxis" href="newaxis.html" />

    <link rel="shortcut icon" href="../../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Integer Array Indices - ndindex documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=6ad9bad0" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=254c7fb8" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #CCCCCC;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #CCCCCC;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #000000bd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-dark-blue);
  --color-brand-content: var(--color-brand-dark-blue);
  --color-sidebar-background: #EEEEEE;
  --color-sidebar-item-background--hover: var(--color-brand-light-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-light-blue);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-light-blue);
  --color-brand-content: var(--color-brand-light-blue);
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-background-primary: black;
  --color-sidebar-background: var(--color-brand-dark-bg);
  --color-sidebar-item-background--hover: var(--color-brand-medium-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-medium-blue);
  --color-problematic: #B30000;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-light-blue);
  --color-brand-content: var(--color-brand-light-blue);
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-background-primary: black;
  --color-sidebar-background: var(--color-brand-dark-bg);
  --color-sidebar-item-background--hover: var(--color-brand-medium-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-medium-blue);
  --color-problematic: #B30000;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ndindex  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/ndindex_logo_white_bg.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/ndindex_logo_dark_bg.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ndindex  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/ndindex.html">ndindex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index-types.html">Index Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/shapetools.html">Shape Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/chunking.html">Chunking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/internal.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Guide to NumPy Indexing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Guide to NumPy Indexing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Introduction: What is an Index?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integer-indices.html">Integer Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slices.html">Slices</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Multidimensional Indices</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Multidimensional Indices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="what-is-an-array.html">What is an Array?</a></li>
<li class="toctree-l3"><a class="reference internal" href="tuples.html">Tuple Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="ellipses.html">Ellipses</a></li>
<li class="toctree-l3"><a class="reference internal" href="newaxis.html">newaxis</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Integer Array Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="boolean-arrays.html">Boolean Array Indices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../other-topics.html">Other Topics Relevant to Indexing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../type-confusion.html">Type Confusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">ndindex Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../style-guide.html">Documentation Style Guide</a></li>
</ul>

</div></div><div class="sidebar-tree sidebar-extra">
  <ul>
    <li class="toctree-l1">
      <a class="sidebar-extra"
      href="https://github.com/Quansight-Labs/ndindex">GitHub<svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-link-external" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.604 1h4.146a.25.25 0 01.25.25v4.146a.25.25 0 01-.427.177L13.03 4.03 9.28 7.78a.75.75 0 01-1.06-1.06l3.75-3.75-1.543-1.543A.25.25 0 0110.604 1zM3.75 2A1.75 1.75 0 002 3.75v8.5c0 .966.784 1.75 1.75 1.75h8.5A1.75 1.75 0 0014 12.25v-3.5a.75.75 0 00-1.5 0v3.5a.25.25 0 01-.25.25h-8.5a.25.25 0 01-.25-.25v-8.5a.25.25 0 01.25-.25h3.5a.75.75 0 000-1.5h-3.5z"></path></svg></a>
    </li>
  </ul>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/Quansight-Labs/ndindex/blob/main/docs/indexing-guide/multidimensional-indices/integer-arrays.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/Quansight-Labs/ndindex/edit/main/docs/indexing-guide/multidimensional-indices/integer-arrays.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="integer-array-indices">
<h1>Integer Array Indices<a class="headerlink" href="#integer-array-indices" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this section and <a class="reference internal" href="boolean-arrays.html"><span class="doc std std-doc">the next</span></a>, do not confuse the <em>array
being indexed</em> with the <em>array that is the index</em>. The former can be anything
and have any dtype. It is only the latter that is restricted to being integer
or boolean.</p>
</div>
<p>Integer array indices are very powerful. Using them, you can effectively
construct arbitrary new arrays consisting of elements from the original
indexed array.</p>
<p>To start, let’s consider a simple one-dimensional array:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span>
</pre></div>
</div>
<p>Now suppose we wish to construct the following 2-D array from this array using
only indexing operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">100</span> <span class="p">],</span>
 <span class="p">[</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">102</span> <span class="p">]]</span>
</pre></div>
</div>
<p>It should hopefully be clear that there’s no way we could possibly construct
this array as <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> using only the index types we’ve discussed so far. For
one thing, <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indices</span></a>, <a class="reference internal" href="../slices.html"><span class="std std-doc">slices</span></a>,
<a class="reference internal" href="ellipses.html"><span class="std std-doc">ellipses</span></a>, and <a class="reference internal" href="newaxis.html"><span class="std std-doc">newaxes</span></a> all only select
elements of the array in order (or possibly <a class="reference internal" href="../slices.html#negative-steps"><span class="std std-ref">reversed order</span></a>
for slices), whereas this array has elements completely shuffled from <code class="docutils literal notranslate"><span class="pre">a</span></code>, and
some are even repeated.</p>
<p>However, we could “cheat” a bit here and do something like</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_array</span>
<span class="go">array([[100, 102, 100],</span>
<span class="go">       [103, 100, 102]])</span>
</pre></div>
</div>
<p>This is the array we want. We sort of constructed it using only indexing
operations, but we didn’t actually do <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> for some index <code class="docutils literal notranslate"><span class="pre">idx</span></code>. Instead,
we just listed the indices of each individual element.</p>
<p>An integer array index is essentially this “cheating” method, but as a single
index. Instead of listing out <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">a[2]</span></code>, and so on, we just create a
single integer array with those <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indices</span></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<p>If we then index <code class="docutils literal notranslate"><span class="pre">a</span></code> with this array, it works just like <code class="docutils literal notranslate"><span class="pre">new_array</span></code> above:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="go">array([[100, 102, 100],</span>
<span class="go">       [103, 100, 102]])</span>
</pre></div>
</div>
<p id="multidimensional-integer-indices">This is how integer array indices work:</p>
<blockquote>
<div><p><strong>An integer array index can construct <em>arbitrary</em> new arrays with elements
from <code class="docutils literal notranslate"><span class="pre">a</span></code>, with the elements in any order and even repeated, simply by
enumerating the integer index positions where each element of the new array
comes from.</strong></p>
</div></blockquote>
<p>Note that <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> above is not the same size as <code class="docutils literal notranslate"><span class="pre">a</span></code> at all. <code class="docutils literal notranslate"><span class="pre">a</span></code> has 4
elements and is 1-dimensional, whereas <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> has 6 elements and is
2-dimensional. <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> also contains some duplicate elements from <code class="docutils literal notranslate"><span class="pre">a</span></code>, and
there are some elements which aren’t selected at all. Indeed, we could take
<em>any</em> integer array <code class="docutils literal notranslate"><span class="pre">idx</span></code> of any shape, and as long as the elements are
between 0 and 3, <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> would create a new array with the same shape as
<code class="docutils literal notranslate"><span class="pre">idx</span></code> with corresponding elements selected from <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>The shape of <code class="docutils literal notranslate"><span class="pre">a</span></code> is <code class="docutils literal notranslate"><span class="pre">(4,)</span></code> and the shape of <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> is <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span></code>, the same as the
shape of <code class="docutils literal notranslate"><span class="pre">idx</span></code>. In general:</p>
<blockquote>
<div><p><strong>an integer array index <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code> selects elements from the specified axis
and replaces the selected dimension in the shape of <code class="docutils literal notranslate"><span class="pre">a</span></code> with the shape of
the index array <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</strong></p>
</div></blockquote>
<p>For example, in <code class="docutils literal notranslate"><span class="pre">a[idx].shape</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code> is replaced with <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span></code>. Consider what
happens when <code class="docutils literal notranslate"><span class="pre">a</span></code> has more than one dimension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># (3,) is replaced with (2, 2)</span>
<span class="go">(2, 2, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Indexing the second dimension, (4,) is replaced with (2, 2)</span>
<span class="go">(3, 2, 2)</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">a.shape</span></code> is <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4)</span></code> and <code class="docutils literal notranslate"><span class="pre">idx.shape</span></code> is <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>. In <code class="docutils literal notranslate"><span class="pre">a[idx].shape</span></code>, the
<code class="docutils literal notranslate"><span class="pre">3</span></code> is replaced with <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>, giving <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">4)</span></code>, and in <code class="docutils literal notranslate"><span class="pre">a[:,</span> <span class="pre">idx].shape</span></code>,
the <code class="docutils literal notranslate"><span class="pre">4</span></code> is replaced with <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>, giving <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">2,</span> <span class="pre">2)</span></code>.</p>
<p>A useful way to think about integer array indexing is that it generalizes
<a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indexing</span></a>. With integer indexing, we are
effectively indexing using a 0-dimensional integer array, that is, a single
integer. This always selects the corresponding element from the given axis and
removes the dimension. That is, it replaces that dimension in the shape with
<code class="docutils literal notranslate"><span class="pre">()</span></code> (i.e., nothing), the “shape” of the integer index. The result of indexing
with an <code class="docutils literal notranslate"><span class="pre">int</span></code> and a corresponding 0-D array is exactly the
same.<a class="footnote-reference brackets" href="#integer-scalar-footnote" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 0-D array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">shape</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># replaces (3,) with ()</span>
<span class="go">(4,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># replaces (4,) with ()</span>
<span class="go">(3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># a[asarray(0)] is the exact same as a[0]</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([0, 1, 2, 3])</span>
</pre></div>
</div>
<p>Note that even when the index array <code class="docutils literal notranslate"><span class="pre">idx</span></code> has more than one dimension, an
integer array index still only selects elements from a single axis of <code class="docutils literal notranslate"><span class="pre">a</span></code>. It
would appear that this limits the ability to arbitrarily shuffle elements of
<code class="docutils literal notranslate"><span class="pre">a</span></code> using integer indexing. For instance, suppose we have the 2-D array</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">]]</span>
</pre></div>
</div>
<p>and we wanted use indexing to create the array <code class="docutils literal notranslate"><span class="pre">[105,</span> <span class="pre">100]</span></code>. Based on the
above examples, this might not seem possible, since the elements <code class="docutils literal notranslate"><span class="pre">105</span></code> and
<code class="docutils literal notranslate"><span class="pre">100</span></code> are not in the same row or column of <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>However, this is doable by providing multiple integer array
indices:</p>
<blockquote id="multiple-integer-arrays">
<div><p><strong>When multiple integer array indices are provided, the elements of each
index are selected correspondingly for that axis.</strong></p>
</div></blockquote>
<p>It’s perhaps most illustrative to show this as an example. Given the above
<code class="docutils literal notranslate"><span class="pre">a</span></code>, we can produce the array <code class="docutils literal notranslate"><span class="pre">[105,</span> <span class="pre">100]</span></code> using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="go">array([105, 100])</span>
</pre></div>
</div>
<p>Let’s break this down. <code class="docutils literal notranslate"><span class="pre">idx</span></code> is a <a class="reference internal" href="tuples.html"><span class="std std-doc">tuple index</span></a> with two arrays,
which are both the same shape. The first element of our desired result, <code class="docutils literal notranslate"><span class="pre">105</span></code>
corresponds to index <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2)</span></code> in <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">np.int64(105)</span>
</pre></div>
</div>
<p>So we write <code class="docutils literal notranslate"><span class="pre">1</span></code> in the first array and <code class="docutils literal notranslate"><span class="pre">2</span></code> in the second array. Similarly, the
next element, <code class="docutils literal notranslate"><span class="pre">100</span></code> corresponds to index <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>, so we write <code class="docutils literal notranslate"><span class="pre">0</span></code> in the
first array and <code class="docutils literal notranslate"><span class="pre">0</span></code> in the second. In general, the first array contains the
indices for the first axis, the second array contains the indices for the
second axis, and so on. If we were to
<a class="reference external" href="https://docs.python.org/3/library/functions.html#zip">zip</a> up our two index
arrays, we would get the set of indices for each corresponding element, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2)</span></code> and <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>.</p>
<p>The resulting array has the same shape as our two index arrays. As before,
this shape can be arbitrary. Suppose we want to create the array</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[[</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">],</span>
  <span class="p">[</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">]],</span>
 <span class="p">[[</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">105</span><span class="p">],</span>
  <span class="p">[</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">102</span><span class="p">]]]</span>
</pre></div>
</div>
<p>Recall our array <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[100, 101, 102],</span>
<span class="go">       [103, 104, 105]])</span>
</pre></div>
</div>
<p>Noting the index for each element in our desired array, we get</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">]</span>
<span class="go">array([[[102, 103],</span>
<span class="go">        [102, 101]],</span>

<span class="go">       [[100, 105],</span>
<span class="go">        [102, 102]]])</span>
</pre></div>
</div>
<p>Again, reading across, the first element, <code class="docutils literal notranslate"><span class="pre">102</span></code> corresponds to index <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">2)</span></code>,
the next element, <code class="docutils literal notranslate"><span class="pre">103</span></code>, corresponds to index <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, and so on.</p>
<section id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Link to this heading">¶</a></h2>
<p>A common use case for integer array indexing is sampling. For example, to
sample <span class="math notranslate nohighlight">\(k\)</span> elements from a 1-D array of size <span class="math notranslate nohighlight">\(n\)</span> with replacement, we can
simply construct an a random integer index in the range <span class="math notranslate nohighlight">\([0, n)\)</span> with <span class="math notranslate nohighlight">\(k\)</span>
elements (see the
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.integers.html#numpy.random.Generator.integers" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.integers()</span></code></a>
documentation):<a class="footnote-reference brackets" href="#random-integers-footnote" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># Seeded so this example reproduces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="c1"># rng.integers() excludes the upper bound</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span>
<span class="go">array([0, 0, 3, 1, 2, 2, 2, 0, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="go">array([100, 100, 103, 101, 102, 102, 102, 100, 101, 100])</span>
</pre></div>
</div>
<p id="permutation-example">Another common use case of integer array indexing is to permute an array. An
array can be randomly permuted with
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.permutation.html#numpy.random.Generator.permutation" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.permutation()</span></code></a>. But what if we want
to permute two arrays with the same permutation? We can compute a permutation
index and apply it to both arrays. For a 1-D array <code class="docutils literal notranslate"><span class="pre">a</span></code> of size <span class="math notranslate nohighlight">\(n\)</span>, a
permutation index is just a permutation of the integer array index
<code class="docutils literal notranslate"><span class="pre">np.arange(n)</span></code>, which itself is the <a class="reference external" href="https://en.wikipedia.org/wiki/identity_permutation">identity
permutation</a> on <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">203</span><span class="p">])</span> <span class="c1"># another array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">identity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">identity</span><span class="p">]</span> <span class="c1"># arange by itself is the identity permutation index</span>
<span class="go">array([100, 101, 102, 103])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># Seeded so this example reproduces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_permutation</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">random_permutation</span><span class="p">]</span>
<span class="go">array([103, 101, 100, 102])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="n">random_permutation</span><span class="p">]</span> <span class="c1"># The same permutation on b</span>
<span class="go">array([203, 201, 200, 202])</span>
</pre></div>
</div>
</section>
<section id="advanced-notes">
<span id="integer-arrays-advanced-notes"></span><h2>Advanced Notes<a class="headerlink" href="#advanced-notes" title="Link to this heading">¶</a></h2>
<p>The information above provides the basic gist of integer array indexing, but
there are also many subtleties and advanced behaviors involved with them. The
subsections here are included for completeness; however, if you are a beginner
NumPy user, you may wish to skip them.</p>
<section id="negative-indices">
<h3>Negative Indices<a class="headerlink" href="#negative-indices" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p><strong>Indices in the integer array can also be negative. Negative indices work
the same as they do with <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indices</span></a>.</strong></p>
</div></blockquote>
<p>Negative and
nonnegative indices can be mixed arbitrarily.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="go">array([100, 101, 103])</span>
</pre></div>
</div>
<p>If you want to convert an index containing negative indices into an index
without any negative indices, you can use the ndindex
<a class="reference internal" href="../../api/index-types.html#ndindex.IntegerArray.reduce" title="ndindex.IntegerArray.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></span></a> method with a <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument.</p>
</section>
<section id="python-lists">
<h3>Python Lists<a class="headerlink" href="#python-lists" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p><strong>You can use a list of integers instead of an array to represent an integer
array index.<a class="footnote-reference brackets" href="#lists-footnote" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></strong></p>
</div></blockquote>
<p>Using a list is useful when writing an array index by hand; however, in all
other cases, using an actual array is preferable. In most real-world
scenarios, an array index is constructed from some other array methods.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">array([100, 101, 103])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># this is the same</span>
<span class="go">array([100, 101, 103])</span>
</pre></div>
</div>
</section>
<section id="bounds-checking">
<h3>Bounds Checking<a class="headerlink" href="#bounds-checking" title="Link to this heading">¶</a></h3>
<p>As with <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indices</span></a>, integer array indexing uses
bounds checking, with the <a class="reference internal" href="../integer-indices.html#integer-indices-bounds-checking"><span class="std std-ref">same rule as integer
indices</span></a>.</p>
<blockquote>
<div><p><strong>If any entry in an integer array index is greater than <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">-</span> <span class="pre">1</span></code> or less
than <code class="docutils literal notranslate"><span class="pre">-size</span></code>, where <code class="docutils literal notranslate"><span class="pre">size</span></code> is the size of the dimension being indexed, an
<code class="docutils literal notranslate"><span class="pre">IndexError</span></code> is raised.</strong></p>
</div></blockquote>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">IndexError</span>: <span class="n">index 4 is out of bounds for axis 0 with size 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">IndexError</span>: <span class="n">index -5 is out of bounds for axis 0 with size 4</span>
</pre></div>
</div>
</section>
<section id="broadcasting">
<span id="integer-array-broadcasting"></span><h3>Broadcasting<a class="headerlink" href="#broadcasting" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p><strong>The integer arrays in an index must either be the same shape or be able to
be <a class="reference internal" href="../other-topics.html#broadcasting"><span class="std std-ref">broadcast</span></a> together to the same shape.</strong></p>
</div></blockquote>
<p>If the arrays are not the same shape, they are first broadcast together, and
those broadcasted arrays are used as the indices. This broadcasting behavior
is useful if the index array would otherwise be repeated in a given dimension,
and provides a convenient way to do outer indexing (see the <a class="reference internal" href="#outer-indexing"><span class="std std-ref">next
section</span></a>).</p>
<p>This also means that mixing an integer array index with a single <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer
index</span></a> is the same as replacing the single integer
index with an array of the same shape filled with that integer (because
remember, a single integer index is the same thing as an integer array index
of shape <code class="docutils literal notranslate"><span class="pre">()</span></code>).</p>
<p>For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>  <span class="c1"># as above</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># idx0 and idx1 broadcast to shape (3, 2), which will</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># be the shape of a[idx0, idx1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">]</span>
<span class="go">array([[103, 100],</span>
<span class="go">       [104, 101],</span>
<span class="go">       [105, 102]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0_broadcasted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1_broadcasted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0_broadcasted</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1_broadcasted</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0_broadcasted</span><span class="p">,</span> <span class="n">idx1_broadcasted</span><span class="p">]</span> <span class="c1"># The same thing as a[idx0, idx1]</span>
<span class="go">array([[103, 100],</span>
<span class="go">       [104, 101],</span>
<span class="go">       [105, 102]])</span>
</pre></div>
</div>
<p id="mixing-array-and-integer">And mixing an array and an integer index:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[100, 101, 102],</span>
<span class="go">       [103, 104, 105]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">array([105, 102, 102])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1_broadcasted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="c1"># The 0-D array &#39;2&#39; broadcasted to shape (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1_broadcasted</span><span class="p">]</span> <span class="c1"># The same thing as a[idx0, 2]</span>
<span class="go">array([105, 102, 102])</span>
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">idx0</span></code> array specifies the indices along the first dimension, <code class="docutils literal notranslate"><span class="pre">1</span></code>,
<code class="docutils literal notranslate"><span class="pre">0</span></code>, and <code class="docutils literal notranslate"><span class="pre">0</span></code>, and the <code class="docutils literal notranslate"><span class="pre">2</span></code> specifies to always use index <code class="docutils literal notranslate"><span class="pre">2</span></code> along the second
dimension. This is the same as using the array <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2]</span></code> for the second
dimension, since this is the scalar <code class="docutils literal notranslate"><span class="pre">2</span></code> broadcasted to the shape of <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p>
<p>The ndindex methods
<a class="reference internal" href="../../api/index-types.html#ndindex.Tuple.broadcast_arrays" title="ndindex.Tuple.broadcast_arrays"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">Tuple.broadcast_arrays()</span></code></span></a> and
<a class="reference internal" href="../../api/index-types.html#ndindex.Tuple.expand" title="ndindex.Tuple.expand"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">expand()</span></code></span></a> will broadcast array indices together into
a canonical form.</p>
<section id="outer-indexing">
<span id="id4"></span><h4>Outer Indexing<a class="headerlink" href="#outer-indexing" title="Link to this heading">¶</a></h4>
<p>The broadcasting behavior for multiple integer indices may seem odd, but it
serves a useful purpose. <a class="reference internal" href="#multiple-integer-arrays"><span class="std std-ref">As we saw above</span></a>, multiple
integer array indices are required to select elements from higher dimensional
arrays, one array for each dimension. These integer arrays enumerate the
indices of the selected elements along these dimensions. For example, as
above:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="c1"># selects elements (1, 2) and (0, 0)</span>
<span class="go">array([105, 100])</span>
</pre></div>
</div>
<p>However, you might have noticed that this behavior is somewhat unusual
compared to other index types. For all other index types we’ve discussed so
far, such as <a class="reference internal" href="../slices.html"><span class="std std-doc">slices</span></a> and <a class="reference internal" href="../integer-indices.html"><span class="std std-doc">integer indices</span></a>,
each index applies “independently” along each dimension. For example, <code class="docutils literal notranslate"><span class="pre">x[0:2,</span> <span class="pre">0:3]</span></code> applies the slice <code class="docutils literal notranslate"><span class="pre">0:2</span></code> to the first dimension of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">0:3</span></code> to the
second dimension. The resulting array has <code class="docutils literal notranslate"><span class="pre">2*3</span> <span class="pre">=</span> <span class="pre">6</span></code> elements, because there
are 3 subarrays selected from the first dimension with 2 elements each. But in
the above example, <code class="docutils literal notranslate"><span class="pre">a[[1,</span> <span class="pre">0],</span> <span class="pre">[2,</span> <span class="pre">0]]</span></code> only has 2 elements, not 4. And
something like <code class="docutils literal notranslate"><span class="pre">a[[1,</span> <span class="pre">0],</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]]</span></code> is an error.</p>
<p>The integer array equivalent of the way slices work is called “outer
indexing”.<a class="footnote-reference brackets" href="#vectorized-indexing-footnote" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> An outer index “<code class="docutils literal notranslate"><span class="pre">a[[1,</span> <span class="pre">0],</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]]</span></code>” would have 6 elements: rows
1 and 0, with elements from columns 2, 0, and 1, in that order. However, the
index <code class="docutils literal notranslate"><span class="pre">a[[1,</span> <span class="pre">0],</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]]</span></code> doesn’t actually work like
this.<a class="footnote-reference brackets" href="#outer-indexing-footnote" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p>
<p>Strictly speaking, though, NumPy’s integer array indexing rules do allow for
outer indexing. This is because, as we saw above, integer array indexing
allows for creating <em>arbitrary</em> new arrays from a given input array. And as it
turns out, the integer arrays required to represent an outer array index are
quite simple to construct. They are simply the outer index arrays broadcasted
together.</p>
<p>To see why this is, consider the above example, <code class="docutils literal notranslate"><span class="pre">a[[1,</span> <span class="pre">0],</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]]</span></code>. We
want our end result to be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">100</span><span class="p">]]</span>
</pre></div>
</div>
<p>That is, the rows of <code class="docutils literal notranslate"><span class="pre">a</span></code> should be in the order <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>, and the columns
should be in the order <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]</span></code>. The end result should be an array of shape
<code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span></code> (which happens to be the same shape as <code class="docutils literal notranslate"><span class="pre">a</span></code>, but that’s just a
coincidence; an outer-indexed array constructed from <code class="docutils literal notranslate"><span class="pre">a</span></code> could have any 2-D
shape). So using the integer array indexing rules above, we need to index <code class="docutils literal notranslate"><span class="pre">a</span></code>
by integer arrays of shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span></code>. Since <code class="docutils literal notranslate"><span class="pre">a</span></code> has two dimensions, we will
need two index arrays, one for each dimension. Let’s consider what these
arrays should be. For the first dimension, we want to select row <code class="docutils literal notranslate"><span class="pre">1</span></code> three
times and then row <code class="docutils literal notranslate"><span class="pre">0</span></code> three times:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<p>And for the second dimension, we want to select the columns <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">0</span></code>, and <code class="docutils literal notranslate"><span class="pre">1</span></code>,
in that order, regardless of which row we are in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<p>In general, we want to repeat each outer selection array along the
corresponding dimension so as to fill an array with the final desired shape.
This is exactly what broadcasting does! If we reshape our first array to have
shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">1)</span></code> and the second array to have shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)</span></code>, then broadcasting
them together will repeat the first dimension of the first array along the
second axis, and the second dimension of the second array along the first
axis, i.e., exactly the arrays we want.</p>
<p>This is why NumPy automatically broadcasts integer array indices together.</p>
<blockquote>
<div><p><strong>Outer indexing arrays can be constructed by inserting size <code class="docutils literal notranslate"><span class="pre">1</span></code> dimensions
into the desired “outer” integer array indices so that the non-size <code class="docutils literal notranslate"><span class="pre">1</span></code>
dimension for each is in the indexing dimension.</strong></p>
</div></blockquote>
<p>For example,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]]</span>
<span class="go">array([[105, 103, 104],</span>
<span class="go">       [102, 100, 101]])</span>
</pre></div>
</div>
<p>Here, we use <a class="reference internal" href="newaxis.html"><span class="std std-doc">newaxis</span></a> along with <code class="docutils literal notranslate"><span class="pre">:</span></code> to turn <code class="docutils literal notranslate"><span class="pre">idx0</span></code> and
<code class="docutils literal notranslate"><span class="pre">idx1</span></code> into shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">1)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)</span></code> arrays, respectively. These then
automatically broadcast together to give the desired outer index.</p>
<p>This “insert size <code class="docutils literal notranslate"><span class="pre">1</span></code> dimensions” operation can also be performed automatically
with the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ix_.html#numpy.ix_" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.ix_()</span></code></a> function.<a class="footnote-reference brackets" href="#ix-footnote" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">)</span>
<span class="go">(array([[1],</span>
<span class="go">       [0]]), array([[2, 0, 1]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">)]</span>
<span class="go">array([[105, 103, 104],</span>
<span class="go">       [102, 100, 101]])</span>
</pre></div>
</div>
<p>Outer indexing can be thought of as a generalization of slicing. With a
<a class="reference internal" href="../slices.html"><span class="std std-doc">slice</span></a>, you can really only select a “regular” sequence of
elements from a dimension, that is, either a contiguous chunk, or a contiguous
chunk split by a regular step value. It’s impossible, for instance, to use a
slice to select the indices <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7]</span></code>, because <code class="docutils literal notranslate"><span class="pre">4</span></code> is omitted.
For instance, say the first dimension of your array represents time steps and
you want to select time steps 0–7, but time step 4 is invalid for some reason
and you want to ignore it for your analysis. If you just care about the first
dimension, you can just use the integer index <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7]</span></code>. But
suppose you also wanted select some other non-contiguous “slice” from the
second dimension. Using just basic indices, you’d have to index the array with
normal slices then either remove or ignore the non-desired indices, neither of
which is ideal. And it would be even more complicated if you also wanted the
indices out-of-order or repeated for some reason.</p>
<p>With outer indexing, you would just construct your “slice” of non-contiguous
indices as integer arrays, turn them into “outer” indices using <code class="docutils literal notranslate"><span class="pre">ix_</span></code> or
manual reshaping, then use that outer index to construct the desired array
directly.</p>
<p>Conversely, a slice like <code class="docutils literal notranslate"><span class="pre">2:9</span></code> is equivalent to the outer index <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8]</span></code>.<a class="footnote-reference brackets" href="#slice-outer-index-footnote" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a></p>
</section>
</section>
<section id="assigning-to-an-integer-array-index">
<h3>Assigning to an Integer Array Index<a class="headerlink" href="#assigning-to-an-integer-array-index" title="Link to this heading">¶</a></h3>
<p>As with all index types discussed in this guide, an integer array index can be
used on the left-hand side of an assignment. This is useful because it allows
you to surgically inject new elements into existing positions in your array.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">203</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([200, 101, 102, 203])</span>
</pre></div>
</div>
<p>However, exercise caution, as this is inherently ambiguous if the index array
contains duplicate elements. For example, suppose we attempted to
set index <code class="docutils literal notranslate"><span class="pre">0</span></code> to both <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">3</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">])</span> <span class="c1"># as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([  3,   2, 102, 103])</span>
</pre></div>
</div>
<p>The end result was <code class="docutils literal notranslate"><span class="pre">3</span></code>. This happened because <code class="docutils literal notranslate"><span class="pre">3</span></code> corresponded to the last <code class="docutils literal notranslate"><span class="pre">0</span></code>
in the index array. But importantly, this is just an implementation detail.
<strong>NumPy makes no guarantees regarding the order in which index elements are
assigned.</strong><a class="footnote-reference brackets" href="#cupy-assignment-footnote" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> If you are using an integer array as an
assignment index, be careful to avoid duplicate entries in the index or, at
the very least, ensure that duplicate entries are always assigned the same
value.</p>
</section>
<section id="combining-integer-arrays-indices-with-basic-indices">
<span id="integer-arrays-combined-with-basic-indices"></span><h3>Combining Integer Arrays Indices with Basic Indices<a class="headerlink" href="#combining-integer-arrays-indices-with-basic-indices" title="Link to this heading">¶</a></h3>
<p>If any <a class="reference internal" href="../slices.html"><span class="std std-doc">slice</span></a>, <a class="reference internal" href="ellipses.html"><span class="std std-doc">ellipsis</span></a>, or
<a class="reference internal" href="newaxis.html"><span class="std std-doc">newaxis</span></a> indices precede or follow all the
<a class="reference internal" href="../integer-indices.html"><span class="doc std std-doc">integer</span></a> and integer array indices in an index, the two
sets of indices operate independently. Slices and ellipses select the
corresponding axes, newaxes add new axes to these locations, and the integer
array indices select the elements on their respective axes, as previously
described.</p>
<p>For example, consider:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>  <span class="c1"># Like above, but with an extra dimension</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">]]])</span>
</pre></div>
</div>
<p>This is the same <code class="docutils literal notranslate"><span class="pre">a</span></code> as in the above examples, except it has an extra size <code class="docutils literal notranslate"><span class="pre">1</span></code>
dimension:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 3)</span>
</pre></div>
</div>
<p>We can select this first dimension with a slice <code class="docutils literal notranslate"><span class="pre">:</span></code>, then use the exact same
index as in the example <a class="reference internal" href="#mixing-array-and-integer"><span class="std std-ref">shown previously</span></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span>
<span class="go">array([1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:,</span> <span class="n">idx0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">array([[105, 102]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:,</span> <span class="n">idx0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
<p>The primary point of this behavior is that you can use <code class="docutils literal notranslate"><span class="pre">...</span></code> at the beginning
of an index to select the last axes of an array using integer array indices,
or several <code class="docutils literal notranslate"><span class="pre">:</span></code>s to select some middle axes. This lets you do with indexing
what you can also do with the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.take.html#numpy.take" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.take()</span></code></a> function.</p>
<p>To be sure though, this index could use any slice, not just <code class="docutils literal notranslate"><span class="pre">:</span></code>, and could
also include newaxes. This behavior is mainly implemented for the sake of
semantic completeness, although it could potentially allow combining two
sequential indexing operations into a single step.</p>
</section>
<section id="integer-array-indices-separated-by-basic-indices">
<h3>Integer Array Indices Separated by Basic Indices<a class="headerlink" href="#integer-array-indices-separated-by-basic-indices" title="Link to this heading">¶</a></h3>
<p>Finally, if the <a class="reference internal" href="../slices.html"><span class="std std-doc">slices</span></a>, <a class="reference internal" href="ellipses.html"><span class="std std-doc">ellipses</span></a>, or
<a class="reference internal" href="newaxis.html"><span class="std std-doc">newaxes</span></a> are <em>in between</em> the integer array indices, then
something more strange happens. The two index types still operate
“independently”; however, unlike the previous case, the shape derived from the
array indices is <em>prepended</em> to the shape derived from the non-array indices.
This is because in these cases there is inherent ambiguity in where these
dimensions should be placed in the final shape.</p>
<p>An example demonstrates this most clearly:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3, 4, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(10, 20)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(10, 20, 3, 4)</span>
</pre></div>
</div>
<p>Here the integer array index shape <code class="docutils literal notranslate"><span class="pre">(10,</span> <span class="pre">20)</span></code> comes first in the result array
and the shape corresponding to the rest of the index, <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4)</span></code>, comes last.</p>
<p>If you find yourself running into this behavior, chances are you would be
better off rewriting the indexing operation to be simpler, for instance, by
first reshaping the array so that the integer array indices are together in
the index. This is considered a design flaw in
NumPy<a class="footnote-reference brackets" href="#advanced-indexing-design-flaw-footnote" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>, and no other Python array
library has replicated it. ndindex will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>
exception on indices like these, because I don’t want to deal with
implementing this obscure
logic.<a class="footnote-reference brackets" href="#ndindex-advanced-indexing-design-flaw-footnote" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></p>
</section>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">¶</a></h2>
<p>Based on the above sections, you should be able to complete the following
exercise: How might you randomly permute a 2-D array using
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.permutation.html#numpy.random.Generator.permutation" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.permutation()</span></code></a> and indexing, so
that each axis is permuted independently? This operation might correspond to
multiplying the array by random <a class="reference external" href="https://en.wikipedia.org/wiki/Permutation_matrix">permutation
matrices</a> on the left and
right, like <span class="math notranslate nohighlight">\(P_1AP_2\)</span>.</p>
<p>For example, the array</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
           <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
           <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>Might be permuted to</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">a_perm</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>(Note that this is not a full permutation of the array. For instance, the
first row <code class="docutils literal notranslate"><span class="pre">[5,</span> <span class="pre">4,</span> <span class="pre">7,</span> <span class="pre">6]</span></code> contains only elements from the second row of <code class="docutils literal notranslate"><span class="pre">a</span></code>.)</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Click here to show the solution</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Suppose we start with the following 2-D array <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0,  1,  2,  3],</span>
<span class="go">       [ 4,  5,  6,  7],</span>
<span class="go">       [ 8,  9, 10, 11]])</span>
</pre></div>
</div>
<p class="sd-card-text">We can generate permutations for the two axes using
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.permutation.html#numpy.random.Generator.permutation" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.permutation()</span></code></a> <a class="reference internal" href="#permutation-example"><span class="std std-ref">as
above</span></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># Seeded so this example reproduces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx0</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">However, we cannot do <code class="docutils literal notranslate"><span class="pre">a[idx0,</span> <span class="pre">idx1]</span></code> as this will fail.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">shape mismatch: indexing arrays could not be broadcast together</span>
<span class="x">with shapes (3,) (4,)</span>
</pre></div>
</div>
<p class="sd-card-text">Remember that we want a permutation of <code class="docutils literal notranslate"><span class="pre">a</span></code>, so the result array should have
the same shape as <code class="docutils literal notranslate"><span class="pre">a</span></code> (<code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4)</span></code>). This should therefore be the broadcasted
shape of <code class="docutils literal notranslate"><span class="pre">idx0</span></code> and <code class="docutils literal notranslate"><span class="pre">idx1</span></code>, which are currently shapes <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>, and <code class="docutils literal notranslate"><span class="pre">(4,)</span></code>. We
can use <a class="reference internal" href="newaxis.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">newaxis</span></code></span></a> to insert dimensions so that they are
shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">1)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">4)</span></code> so that they broadcast together to this shape.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">idx0</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]]</span>
<span class="go">array([[ 5,  4,  6,  7],</span>
<span class="go">       [ 1,  0,  2,  3],</span>
<span class="go">       [ 9,  8, 10, 11]])</span>
</pre></div>
</div>
<p class="sd-card-text">You can check that this is a permutation of <code class="docutils literal notranslate"><span class="pre">a</span></code> where each axis is permuted
independently.</p>
<p class="sd-card-text">We can also interpret this as an <a class="reference internal" href="#outer-indexing"><span class="std std-ref">outer indexing</span></a> operation.
In this case, our non-contiguous “slices” that we are outer indexing by are a
full slice along each axis, just permuted. We can use the <code class="docutils literal notranslate"><span class="pre">ix_()</span></code> helper to
construct the same index as above</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span><span class="p">)]</span>
<span class="go">array([[ 5,  4,  6,  7],</span>
<span class="go">       [ 1,  0,  2,  3],</span>
<span class="go">       [ 9,  8, 10, 11]])</span>
</pre></div>
</div>
<p class="sd-card-text">As an extra bonus, here’s how we can interpret this as a multiplication by
permutation matrices, using the same indices (but of course, simply permuting
<code class="docutils literal notranslate"><span class="pre">a</span></code> directly with the indices is more efficient):</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)[</span><span class="n">idx0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)[</span><span class="n">idx1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P1</span> <span class="o">@</span> <span class="n">a</span> <span class="o">@</span> <span class="n">P2</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[ 5,  4,  6,  7],</span>
<span class="go">       [ 1,  0,  2,  3],</span>
<span class="go">       [ 9,  8, 10, 11]])</span>
</pre></div>
</div>
<p class="sd-card-text">Can you see why this works?</p>
</div>
</details><p class="rubric">Footnotes</p>
<!-- Footnotes are written inline above but markdown will put them here at the
end of the document. -->
</section>
</section>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="integer-scalar-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<!-- This is the only way to cross reference a footnote across documents -->
<p id="integer-scalar-footnote-ref">There is one difference between <code class="docutils literal notranslate"><span class="pre">a[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">a[asarray(0)]</span></code>. The
latter is considered an advanced index, so it does not create a
<a class="reference internal" href="../other-topics.html#views-vs-copies"><span class="std std-ref">view</span></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
<p>In ndindex,
<a class="reference internal" href="../../api/index-types.html#ndindex.IntegerArray.reduce" title="ndindex.IntegerArray.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">IntegerArray.reduce()</span></code></span></a> will always convert
a 0-D array index into an <a class="reference internal" href="../../api/index-types.html#ndindex.Integer" title="ndindex.integer.Integer"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Integer</span></code></span></a>.</p>
</aside>
<aside class="footnote brackets" id="random-integers-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Note that <code class="docutils literal notranslate"><span class="pre">np.random</span></code> also supports this
operation directly with
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.choice.html#numpy.random.Generator.choice" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.choice()</span></code></a>.</p>
</aside>
<aside class="footnote brackets" id="lists-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Beware that <a class="reference external" href="https://numpy.org/doc/stable/release/1.23.0-notes.html#expired-deprecations">versions of NumPy prior to
1.23</a>
treated a single list as a <a class="reference internal" href="tuples.html"><span class="std std-doc">tuple index</span></a> rather than as an
array.</p>
</aside>
<aside class="footnote brackets" id="vectorized-indexing-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">4</a><span class="fn-bracket">]</span></span>
<p>The type of integer array indexing that NumPy
uses where arrays are broadcasted and “zipped” together is sometimes called
“vectorized indexing” or “inner indexing”. The “outer” and “inner” are
because they act like an outer- or inner-product.</p>
</aside>
<aside class="footnote brackets" id="outer-indexing-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">5</a><span class="fn-bracket">]</span></span>
<p>Outer indexing is how integer array indexing works
in many other languages such as MATLAB, Fortran, and R. There is a proposed
<a class="reference external" href="https://numpy.org/neps/nep-0021-advanced-indexing.html">NEP</a> to add more
direct support for outer indexing like this to NumPy, but it hasn’t been
accepted yet.</p>
</aside>
<aside class="footnote brackets" id="ix-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">6</a><span class="fn-bracket">]</span></span>
<p><code class="docutils literal notranslate"><span class="pre">ix_()</span></code> is currently limited to only support 1-D input arrays
and can’t be mixed with other index types. In the general case you will
need to apply the reshaping operation manually. There is an <a class="reference external" href="https://github.com/Quansight-Labs/ndindex/issues/29">open
issue</a> to implement
this more generally in ndindex.</p>
</aside>
<aside class="footnote brackets" id="slice-outer-index-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">7</a><span class="fn-bracket">]</span></span>
<p>They aren’t actually equivalent, because <a class="reference internal" href="../other-topics.html#views-vs-copies"><span class="std std-ref">a
slice creates a view and an integer array index creates a
copy</span></a>, not to mention the fact that slices
<a class="reference internal" href="../slices.html#clipping"><span class="std std-ref">clip</span></a> and integer arrays have bounds checks. If your index can
be represented as a slice, it’s usually better to use an actual <code class="docutils literal notranslate"><span class="pre">slice</span></code>.</p>
</aside>
<aside class="footnote brackets" id="cupy-assignment-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">8</a><span class="fn-bracket">]</span></span>
<p>For example, in <a class="reference external" href="https://cupy.dev/">CuPy</a>,
which implements the NumPy API on top of GPUs, <a class="reference external" href="https://docs.cupy.dev/en/stable/reference/generated/cupy.ndarray.html#cupy.ndarray.__setitem__">the behavior of this sort
of thing is
undefined</a>.
This is because CuPy parallelizes the assignment operation on the GPU, and
the element that gets assigned to the duplicate index “last” becomes
dependent on a race condition.</p>
</aside>
<aside class="footnote brackets" id="advanced-indexing-design-flaw-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">9</a><span class="fn-bracket">]</span></span>
<p>Travis Oliphant, the original
creator of NumPy, told me privately that “somebody should have slapped me
with a wet fish” when he designed this.</p>
</aside>
<aside class="footnote brackets" id="ndindex-advanced-indexing-design-flaw-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">10</a><span class="fn-bracket">]</span></span>
<p>I might accept a pull
request implementing it, but I’m not going to do it myself.</p>
</aside>
</aside>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="boolean-arrays.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Boolean Array Indices</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="newaxis.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">newaxis</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, Quansight Labs
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/Quansight-Labs/ndindex" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Integer Array Indices</a><ul>
<li><a class="reference internal" href="#use-cases">Use Cases</a></li>
<li><a class="reference internal" href="#advanced-notes">Advanced Notes</a><ul>
<li><a class="reference internal" href="#negative-indices">Negative Indices</a></li>
<li><a class="reference internal" href="#python-lists">Python Lists</a></li>
<li><a class="reference internal" href="#bounds-checking">Bounds Checking</a></li>
<li><a class="reference internal" href="#broadcasting">Broadcasting</a><ul>
<li><a class="reference internal" href="#outer-indexing">Outer Indexing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assigning-to-an-integer-array-index">Assigning to an Integer Array Index</a></li>
<li><a class="reference internal" href="#combining-integer-arrays-indices-with-basic-indices">Combining Integer Arrays Indices with Basic Indices</a></li>
<li><a class="reference internal" href="#integer-array-indices-separated-by-basic-indices">Integer Array Indices Separated by Basic Indices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise">Exercise</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS"}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>