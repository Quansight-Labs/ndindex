<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API Reference" href="api/index.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>ndindex documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=16cf08d2" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=254c7fb8" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #CCCCCC;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #CCCCCC;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #000000bd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-dark-blue);
  --color-brand-content: var(--color-brand-dark-blue);
  --color-sidebar-background: #EEEEEE;
  --color-sidebar-item-background--hover: var(--color-brand-light-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-light-blue);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-light-blue);
  --color-brand-content: var(--color-brand-light-blue);
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-background-primary: black;
  --color-sidebar-background: var(--color-brand-dark-bg);
  --color-sidebar-item-background--hover: var(--color-brand-medium-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-medium-blue);
  --color-problematic: #B30000;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --code-font-size: var(--font-size--small);
  --color-highlight-on-target: var(--color-highlighted-background);
  --color-brand-primary: var(--color-brand-light-blue);
  --color-brand-content: var(--color-brand-light-blue);
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-background-primary: black;
  --color-sidebar-background: var(--color-brand-dark-bg);
  --color-sidebar-item-background--hover: var(--color-brand-medium-blue);
  --color-sidebar-item-expander-background--hover: var(--color-brand-medium-blue);
  --color-problematic: #B30000;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">ndindex  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="#">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/ndindex_logo_white_bg.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/ndindex_logo_dark_bg.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ndindex  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/ndindex.html">ndindex</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/index-types.html">Index Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/shapetools.html">Shape Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/chunking.html">Chunking</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/internal.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="indexing-guide/index.html">Guide to NumPy Indexing</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Guide to NumPy Indexing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="indexing-guide/intro.html">Introduction: What is an Index?</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing-guide/integer-indices.html">Integer Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing-guide/slices.html">Slices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="indexing-guide/multidimensional-indices/index.html">Multidimensional Indices</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Multidimensional Indices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/what-is-an-array.html">What is an Array?</a></li>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/tuples.html">Tuple Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/ellipses.html">Ellipses</a></li>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/newaxis.html">newaxis</a></li>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/integer-arrays.html">Integer Array Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="indexing-guide/multidimensional-indices/boolean-arrays.html">Boolean Array Indices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="indexing-guide/other-topics.html">Other Topics Relevant to Indexing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="type-confusion.html">Type Confusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">ndindex Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">Documentation Style Guide</a></li>
</ul>

</div></div><div class="sidebar-tree sidebar-extra">
  <ul>
    <li class="toctree-l1">
      <a class="sidebar-extra"
      href="https://github.com/Quansight-Labs/ndindex">GitHub<svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-link-external" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.604 1h4.146a.25.25 0 01.25.25v4.146a.25.25 0 01-.427.177L13.03 4.03 9.28 7.78a.75.75 0 01-1.06-1.06l3.75-3.75-1.543-1.543A.25.25 0 0110.604 1zM3.75 2A1.75 1.75 0 002 3.75v8.5c0 .966.784 1.75 1.75 1.75h8.5A1.75 1.75 0 0014 12.25v-3.5a.75.75 0 00-1.5 0v3.5a.25.25 0 01-.25.25h-8.5a.25.25 0 01-.25-.25v-8.5a.25.25 0 01.25-.25h3.5a.75.75 0 000-1.5h-3.5z"></path></svg></a>
    </li>
  </ul>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/Quansight-Labs/ndindex/blob/main/docs/index.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/Quansight-Labs/ndindex/edit/main/docs/index.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="ndindex">
<h1>ndindex<a class="headerlink" href="#ndindex" title="Link to this heading">¶</a></h1>
<p>A Python library for manipulating indices of ndarrays.</p>
<p>ndindex is a library that allows representing and manipulating objects that
can be valid indices to numpy arrays, i.e., slices, integers, ellipses,
None, integer and boolean arrays, and tuples thereof. The goals of the library
are</p>
<ul class="simple">
<li><p>Provide a uniform API to manipulate these objects. Unlike the standard index
objects themselves like <code class="docutils literal notranslate"><span class="pre">slice</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, and <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, which do not share any
methods in common related to being indices, ndindex classes can all be
manipulated uniformly. For example, <code class="docutils literal notranslate"><span class="pre">idx.args</span></code> always gives the arguments
used to construct <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></li>
<li><p>Give 100% correct semantics as defined by numpy’s ndarray. This means that
ndindex will not make a transformation on an index object unless it is
correct for all possible input array shapes. The only exception to this rule
is that ndindex assumes that any given index will not raise <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>
(for instance, from an out of bounds integer index or from too few
dimensions). For those operations where the array shape is known, there is a
<a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.reduce" title="ndindex.ndindex.NDIndex.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></span></a> method to reduce an index to a simpler index
that is equivalent for the given shape.</p></li>
<li><p>Enable useful transformation and manipulation functions on index objects.</p></li>
</ul>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Link to this heading">¶</a></h2>
<p>If you’ve ever worked with Python’s <code class="docutils literal notranslate"><span class="pre">slice</span></code> objects, you will quickly discover
their limitations:</p>
<ul>
<li><p>Extracting the arguments of a <code class="docutils literal notranslate"><span class="pre">slice</span></code> is cumbersome. You have to write
<code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">stop,</span> <span class="pre">step</span> <span class="pre">=</span> <span class="pre">s.start,</span> <span class="pre">s.stop,</span> <span class="pre">s.step</span></code>. With ndindex you can write
<code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">stop,</span> <span class="pre">step</span> <span class="pre">=</span> <span class="pre">s.args</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">slice</span></code> objects are not hashable. If you want to use them as dictionary
keys, you have to use cumbersome translation back and forth to a hashable
type such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">slice</span></code> makes no assumptions about what they are slicing. As a result,
invalid slices like <code class="docutils literal notranslate"><span class="pre">slice(0.5)</span></code> or <code class="docutils literal notranslate"><span class="pre">slice(0,</span> <span class="pre">10,</span> <span class="pre">0)</span></code> are allowed. Also
slices that would always be equivalent like <code class="docutils literal notranslate"><span class="pre">slice(None,</span> <span class="pre">10)</span></code> and <code class="docutils literal notranslate"><span class="pre">slice(0,</span> <span class="pre">10)</span></code> are unequal. To contrast, ndindex objects always assume they are
indices to numpy arrays and type check their input, and the
<a class="reference internal" href="api/index-types.html#ndindex.Slice.reduce" title="ndindex.Slice.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></span></a> method can be used to put the arguments into
canonical form.</p></li>
<li><p>Once you start generalizing <code class="docutils literal notranslate"><span class="pre">slice</span></code> objects to more general indices, it is
difficult to work with them in a uniform way. For example, <code class="docutils literal notranslate"><span class="pre">a[i]</span></code> and
<code class="docutils literal notranslate"><span class="pre">a[(i,)]</span></code> are always equivalent for numpy arrays, but <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">slice</span></code>,
<code class="docutils literal notranslate"><span class="pre">int</span></code>, etc. are not related to one another. To contrast, all ndindex types
have a uniform API, and all relevant operations on them produce ndindex
objects.</p></li>
<li><p>The above limitations can be annoying, but you might consider them worth
living with. The real pain comes when you start trying to do slice
arithmetic. <a class="reference internal" href="indexing-guide/slices.html"><span class="std std-doc">Slices in Python</span></a> behave
fundamentally differently depending on whether the step is positive or
negative and the start and stop are positive, negative, or None. Consider,
for example, the meaning of the slice <code class="docutils literal notranslate"><span class="pre">a[4:-2:-2]</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> is a
one-dimensional array. This slices every other element from the fifth
element to the second from the last, but not including the second from last.
The resulting array will have shape <code class="docutils literal notranslate"><span class="pre">(0,)</span></code> if the original shape is less
than 1 or greater than 5, and shape <code class="docutils literal notranslate"><span class="pre">(1,)</span></code> otherwise. In ndindex, one can
use <code class="docutils literal notranslate"><span class="pre">len(Slice(4,</span> <span class="pre">-2,</span> <span class="pre">-2))</span></code> to compute the maximum length of this slice
(<code class="docutils literal notranslate"><span class="pre">1</span></code>), or <code class="docutils literal notranslate"><span class="pre">len(Slice(4,</span> <span class="pre">-2,</span> <span class="pre">-2).reduce(shape))</span></code> to compute the length for a
specific array shape. See <a class="reference internal" href="api/index-types.html#ndindex.Slice.__len__" title="ndindex.Slice.__len__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ndindex.Slice.__len__()</span></code></a> and
<a class="reference internal" href="api/index-types.html#ndindex.Slice.reduce" title="ndindex.Slice.reduce"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ndindex.Slice.reduce()</span></code></a>.</p>
<p>ndindex pre-codes common slice arithmetic into useful abstractions so you
don’t have to try to figure out all the different cases yourself. And due to
<a class="reference internal" href="#testing"><span class="std std-ref">extensive testing</span></a>, you can be assured that ndindex is correct.</p>
</li>
</ul>
</section>
<section id="installation">
<span id="id1"></span><h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>ndindex can be installed using pip (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">ndindex</span></code>) or conda (<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-f</span> <span class="pre">conda-forge</span> <span class="pre">ndindex</span></code>).</p>
<section id="experimental-cythonization">
<h3>Experimental Cythonization<a class="headerlink" href="#experimental-cythonization" title="Link to this heading">¶</a></h3>
<p>When installing ndindex from source (using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code>) all
Python modules (except tests) will be Cythonized when Cython and a working
compiler are installed. This can improve the general performance of ndindex.
The environment variable <code class="docutils literal notranslate"><span class="pre">CYTHONIZE_NDINDEX</span></code> is used to explicitly control
this default behavior:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CYTHONIZE_NDINDEX=0</span></code>: disables Cythonization (even if a
working Cython environment is available).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CYTHONIZE_NDINDEX=1</span></code>: force Cythonization (will fail when Cython or a
compiler isn’t present).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CYTHONIZE_NDINDEX</span></code> not set: the default behavior (Cythonize if Cython is
installed and working).</p></li>
</ul>
<p>Cythonization is still experimental, and is only enabled for direct source
installations. The pip and conda packages are not Cythonized. Future versions
of ndindex may enable Cythonization for all installs.</p>
</section>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h2>
<p>ndindex is still a work in progress. The following things are currently
implemented:</p>
<ul>
<li><p><a class="reference internal" href="api/index-types.html#ndindex.Slice" title="ndindex.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a>, <a class="reference internal" href="api/index-types.html#ndindex.Integer" title="ndindex.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference internal" href="api/index-types.html#ndindex.ellipsis" title="ndindex.ellipsis"><code class="xref py py-class docutils literal notranslate"><span class="pre">ellipsis</span></code></a>, <a class="reference internal" href="api/index-types.html#ndindex.Tuple" title="ndindex.Tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code></a>,
<a class="reference internal" href="api/index-types.html#ndindex.Newaxis" title="ndindex.Newaxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Newaxis</span></code></a>, <a class="reference internal" href="api/index-types.html#ndindex.IntegerArray" title="ndindex.IntegerArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegerArray</span></code></a>, and <a class="reference internal" href="api/index-types.html#ndindex.BooleanArray" title="ndindex.BooleanArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">BooleanArray</span></code></a>
classes to represent any valid index to a NumPy array.</p></li>
<li><p>Classes do not canonicalize by default (the constructor only does basic type
checking). Objects can be put into canonical form by calling
<a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.reduce" title="ndindex.ndindex.NDIndex.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></span></a>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ndindex</span> <span class="kn">import</span> <span class="n">Slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">Slice(None, 12, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">Slice(0, 12, 1)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reduce()</span></code> can also be called with a <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument.
<a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.reduce" title="ndindex.ndindex.NDIndex.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx.reduce(shape)</span></code></span></a> reduces an index to an equivalent
index over an array with the given shape.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">((</span><span class="mi">10</span><span class="p">,))</span>
<span class="go">Slice(2, 9, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([2, 3, 4, 5, 6, 7, 8])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([2, 3, 4, 5, 6, 7, 8])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reduce()</span></code> simplifies all index types, but for <a class="reference internal" href="api/index-types.html#ndindex.Slice.reduce" title="ndindex.Slice.reduce"><span class="xref myst py py-meth">slice indices</span></a>
in particular, it always puts them into canonical form, so that
<code class="docutils literal notranslate"><span class="pre">s1.reduce()</span></code> and <code class="docutils literal notranslate"><span class="pre">s2.reduce()</span></code> will give the same resulting <code class="docutils literal notranslate"><span class="pre">Slice</span></code> if and
only if <code class="docutils literal notranslate"><span class="pre">s1</span></code> always slices the same elements as <code class="docutils literal notranslate"><span class="pre">s2</span></code>. If no shape is given,
<code class="docutils literal notranslate"><span class="pre">s.reduce()</span></code> returns a canonical slice that is equivalent to <code class="docutils literal notranslate"><span class="pre">s</span></code> for all
array shapes. This can be used to test slice equality without indexing an
array.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">Slice(2, 3, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">Slice(2, 3, 1)</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Slice(1, 2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Slice(1, 2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[1]</span>
</pre></div>
</div>
</li>
<li><p>Object arguments can be accessed with <code class="docutils literal notranslate"><span class="pre">idx.args</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
<span class="go">(1, 3, None)</span>
</pre></div>
</div>
<p>ndindex objects can always be recreated exactly from their args, so that
<code class="docutils literal notranslate"><span class="pre">type(idx)(idx.args)</span> <span class="pre">==</span> <span class="pre">idx</span></code>.</p>
</li>
<li><p>All ndindex objects are immutable/hashable and can be used as dictionary keys.</p></li>
<li><p>ndindex objects can be compared using <code class="docutils literal notranslate"><span class="pre">==</span></code>, even if they contain array
indices. Note that <code class="docutils literal notranslate"><span class="pre">==</span></code> does exact equality comparison. Use
<a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.reduce" title="ndindex.ndindex.NDIndex.reduce"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx1.reduce(shape)</span> <span class="pre">==</span> <span class="pre">idx2.reduce(shape)</span></code></span></a> (see above) to
test if two indices index the same elements as each other (n.b. pure
canonicalization is currently only guaranteed for slice indices).</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ndindex</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This would fail with ValueError for a Python tuple containing an array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tuple</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">Tuple</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p>A real index object can be accessed with <a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.raw" title="ndindex.ndindex.NDIndex.raw"><span class="xref myst py py-attr"><code class="docutils literal notranslate"><span class="pre">idx.raw</span></code></span></a>. Use this
to use an ndindex index to index an array.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="n">s</span><span class="o">.</span><span class="n">raw</span><span class="p">]</span>
<span class="go">array([0, 1])</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/index-types.html#ndindex.Slice.__len__" title="ndindex.Slice.__len__"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">len()</span></code></span></a> computes the maximum length of a slice index (over
the first axis).</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">Slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.isempty" title="ndindex.ndindex.NDIndex.isempty"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx.isempty()</span></code></span></a> returns True if an index always indexes
to an empty array (an array with a 0 in its shape). <code class="docutils literal notranslate"><span class="pre">isempty</span></code> can also be
called with a shape like <code class="docutils literal notranslate"><span class="pre">idx.isempty(shape)</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isempty</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.expand" title="ndindex.ndindex.NDIndex.expand"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx.expand(shape)</span></code></span></a> expands an index so that it is as
explicit as possible. An expanded index is always a <a class="reference internal" href="api/index-types.html#ndindex.Tuple" title="ndindex.Tuple"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Tuple</span></code></span></a>
where each indexed axis is indexed explicitly.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ndindex</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tuple</span><span class="p">(</span><span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="o">...</span><span class="p">,</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="go">Tuple(slice(0, 10, 1), slice(0, 11, 1), slice(1, 12, 1))</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.newshape" title="ndindex.ndindex.NDIndex.newshape"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx.newshape(shape)</span></code></span></a> returns the shape of <code class="docutils literal notranslate"><span class="pre">a[idx]</span></code>,
assuming <code class="docutils literal notranslate"><span class="pre">a</span></code> has shape <code class="docutils literal notranslate"><span class="pre">shape</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Tuple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">newshape</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">(10, 5)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.broadcast_arrays" title="ndindex.ndindex.NDIndex.broadcast_arrays"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">idx.broadcast_arrays()</span></code></span></a> broadcasts the array
indices in <code class="docutils literal notranslate"><span class="pre">idx</span></code>, and converts boolean arrays into equivalent integer arrays.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Tuple</span><span class="p">(</span><span class="n">array</span><span class="p">([[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">()</span>
<span class="go">Tuple([0, 1], [0, 0], [0, 1])</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.as_subindex" title="ndindex.ndindex.NDIndex.as_subindex"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">i.as_subindex(j)</span></code></span></a> produces an index <code class="docutils literal notranslate"><span class="pre">k</span></code> such that
<code class="docutils literal notranslate"><span class="pre">a[j][k]</span></code> gives all the elements of <code class="docutils literal notranslate"><span class="pre">a[j]</span></code> that are also in <code class="docutils literal notranslate"><span class="pre">a[i]</span></code> (see the
<a class="reference internal" href="api/internal.html#ndindex.ndindex.NDIndex.as_subindex" title="ndindex.ndindex.NDIndex.as_subindex"><span class="xref myst py py-meth">documentation</span></a> for more information). This is useful
for re-indexing an index onto chunks of an array.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">Slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">Slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">as_subindex</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Slice(50, 100, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">as_subindex</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Slice(0, 60, 1)</span>
</pre></div>
</div>
</li>
<li><p>The <a class="reference internal" href="api/chunking.html#ndindex.ChunkSize" title="ndindex.ChunkSize"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ChunkSize</span></code></span></a> object abstracts splitting an array
into uniform chunks and contains methods to compute things about these
chunks:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ndindex</span> <span class="kn">import</span> <span class="n">ChunkSize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_size</span> <span class="o">=</span> <span class="n">ChunkSize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_size</span><span class="o">.</span><span class="n">num_chunks</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="go">5100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_size</span><span class="o">.</span><span class="n">containing_block</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">1050</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)),</span> <span class="n">shape</span><span class="p">)</span>
<span class="go">Tuple(slice(400, 1100, 1), slice(0, 200, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">chunk_size</span><span class="o">.</span><span class="n">as_subchunks</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<span class="go">Tuple(slice(400, 500, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(500, 600, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(600, 700, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(700, 800, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(800, 900, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(900, 1000, 1), slice(0, 200, 1))</span>
<span class="go">Tuple(slice(1000, 1100, 1), slice(0, 200, 1))</span>
</pre></div>
</div>
</li>
<li><p>Additionally, the ndindex documentation contains an extensive <a class="reference internal" href="indexing-guide/index.html"><span class="std std-doc">guide to
NumPy indexing</span></a>, which goes over how all NumPy
index types work, and should be useful to all users of NumPy even if you
aren’t a user of ndindex.</p></li>
</ul>
<p>The following things are not yet implemented, but are planned.</p>
<ul class="simple">
<li><p>Composition: <code class="docutils literal notranslate"><span class="pre">i1[i2]</span></code> will create a new ndindex object <code class="docutils literal notranslate"><span class="pre">i3</span></code> (when possible)
so that <code class="docutils literal notranslate"><span class="pre">a[i1][i2]</span> <span class="pre">==</span> <span class="pre">a[i3]</span></code>.</p></li>
<li><p>Various set-like operations on indices, including “contains”, “union”, and
“intersection”. For example, <code class="docutils literal notranslate"><span class="pre">i1</span> <span class="pre">+</span> <span class="pre">i2</span></code> will produce a single index so that
<code class="docutils literal notranslate"><span class="pre">a[i1</span> <span class="pre">+</span> <span class="pre">i2]</span></code> gives all the elements of <code class="docutils literal notranslate"><span class="pre">a[i1]</span></code> and <code class="docutils literal notranslate"><span class="pre">a[i2]</span></code>.</p></li>
<li><p>Support <a class="reference external" href="https://numpy.org/neps/nep-0021-advanced-indexing.html">NEP 21 advanced
indexing</a>.</p></li>
<li><p>Support for generating symbolic formulas for the above operations using
<a class="reference external" href="https://www.sympy.org/">SymPy</a>.</p></li>
</ul>
<p>And more. If there is something you would like to see this library be able to
do, please <a class="reference external" href="https://github.com/quansight-labs/ndindex/issues">open an issue</a>. Pull
requests are welcome as well.</p>
</section>
<section id="testing-and-correctness">
<span id="testing"></span><h2>Testing and correctness<a class="headerlink" href="#testing-and-correctness" title="Link to this heading">¶</a></h2>
<p>The most important priority for a library like this is correctness. Index
manipulations, and especially slice manipulations, are complicated to code
correctly, and the code for them typically involves dozens of different
branches for different cases.</p>
<p>In order to assure correctness, all operations are tested extensively against
numpy itself to ensure they give the same results. The basic idea is to take
the pure Python <code class="docutils literal notranslate"><span class="pre">index</span></code> and the <code class="docutils literal notranslate"><span class="pre">ndindex(index).raw</span></code>, or in the case of a
transformation, the before and after raw index, and index a <code class="docutils literal notranslate"><span class="pre">numpy.arange</span></code>
with them (the input array itself doesn’t matter, so long as its values are
distinct). If they do not give the same output array, or do not both produce
the same error (like an <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>), the code is not correct. For example,
the <code class="docutils literal notranslate"><span class="pre">reduce()</span></code> method can be verified by checking that <code class="docutils literal notranslate"><span class="pre">a[idx.raw]</span></code> and
<code class="docutils literal notranslate"><span class="pre">a[idx.reduce(a.shape).raw]</span></code> produce the same sub-arrays for all possible
input arrays <code class="docutils literal notranslate"><span class="pre">a</span></code> and ndindex objects <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
<p>There are two primary types of tests that we employ to verify this:</p>
<ul class="simple">
<li><p><strong>Exhaustive tests</strong>. These test every possible value in some range. For
example, slice tests test all possible <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">stop</span></code>, and <code class="docutils literal notranslate"><span class="pre">step</span></code> values in
the range <span class="math notranslate nohighlight">\([-10, 10]\)</span>, as well as <code class="docutils literal notranslate"><span class="pre">None</span></code>, on <code class="docutils literal notranslate"><span class="pre">numpy.arange(n)</span></code> for <code class="docutils literal notranslate"><span class="pre">n</span></code> in
the range <span class="math notranslate nohighlight">\([0, 10]\)</span>. This is the best type of test, because it checks every
possible case. Unfortunately, it is often impossible to do full exhaustive
testing due to combinatorial explosion. For example, it would be impossible
to exhaustively test tuple indices, even with a severely restricted search
space, and the situation is even worse with integer array indices.</p></li>
<li><p><strong>Hypothesis tests</strong>.
<a class="reference external" href="https://hypothesis.readthedocs.io/en/latest/index.html">Hypothesis</a> is a
library that can intelligently check a combinatorial search space of inputs.
This requires writing hypothesis strategies that can generate all the
relevant types of indices (see
<a class="reference external" href="https://github.com/Quansight-Labs/ndindex/blob/main/ndindex/tests/helpers.py">ndindex/tests/helpers.py</a>).
All tests have hypothesis tests, even if they are also tested exhaustively.</p></li>
</ul>
<p>Why bother with Hypothesis if the same thing is already tested exhaustively?
The main reason is that hypothesis is much better at producing human-readable
failure examples. When an exhaustive test fails, the failure will always be
from the first set of inputs in the loop that produces a failure. Hypothesis
on the other hand attempts to “shrink” the failure input to smallest input
that still fails. For example, a failing exhaustive slice test might give
<code class="docutils literal notranslate"><span class="pre">Slice(-10,</span> <span class="pre">-9,</span> <span class="pre">-10)</span></code> as a the failing example, but hypothesis would shrink it
to <code class="docutils literal notranslate"><span class="pre">Slice(-2,</span> <span class="pre">-1,</span> <span class="pre">-1)</span></code>. Another reason for the duplication is that hypothesis
can sometimes test a slightly expanded test space without any additional
consequences. For example,
<a class="reference external" href="https://github.com/Quansight-Labs/ndindex/blob/8875637bf223f92672db9292ec537c9d98ae382e/ndindex/tests/test_slice.py#L165"><code class="docutils literal notranslate"><span class="pre">test_slice_reduce_hypothesis()</span></code></a>
in tests all types of array shapes, whereas
<a class="reference external" href="https://github.com/Quansight-Labs/ndindex/blob/8875637bf223f92672db9292ec537c9d98ae382e/ndindex/tests/test_slice.py#L142"><code class="docutils literal notranslate"><span class="pre">test_slice_reduce_exhaustive()</span></code></a>
tests only 1-dimensional shapes. This doesn’t affect things because hypotheses
will always shrink large shapes to a 1-dimensional shape in the case of a
failure. Consequently every exhaustive test will also have a corresponding
hypothesis test.</p>
</section>
<section id="benchmarks">
<h2>Benchmarks<a class="headerlink" href="#benchmarks" title="Link to this heading">¶</a></h2>
<p>Benchmarks for ndindex are published
<a class="reference external" href="https://quansight-labs.github.io/ndindex/benchmarks/">here</a>.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/Quansight-Labs/ndindex/blob/main/LICENSE">MIT License</a></p>
</section>
<section id="acknowledgments">
<span id="id2"></span><h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Link to this heading">¶</a></h2>
<p>ndindex development is supported by <a class="reference external" href="https://labs.quansight.org/">Quansight
Labs</a> and is sponsored in part by <a class="reference external" href="https://www.deshaw.com/">the D. E.
Shaw group</a>. The D. E. Shaw group collaborates with
Quansight on numerous open source projects, including Numba, Dask and Project
Jupyter.</p>
<div style="text-align:center">
<a class="reference external image-reference" href="https://labs.quansight.org/"><img alt="https://labs.quansight.org/images/QuansightLabs_logo_V2.png" class="only-light-inline" src="https://labs.quansight.org/images/QuansightLabs_logo_V2.png" style="width: 200px;"></a>
<a class="reference external image-reference" href="https://labs.quansight.org/"><img alt="https://labs.quansight.org/images/QuansightLabs_logo_V2_white.png" class="only-dark-inline" src="https://labs.quansight.org/images/QuansightLabs_logo_V2_white.png" style="width: 200px;"></a>
<a class="reference external image-reference" href="https://www.deshaw.com"><img alt="https://www.deshaw.com/" class="only-light-inline" src="https://www.deshaw.com/assets/logos/blue_logo_417x125.png" style="width: 200px;"></a>
<a class="reference external image-reference" href="https://www.deshaw.com"><img alt="https://www.deshaw.com/" class="only-dark-inline" src="https://www.deshaw.com/assets/svg/embedded/logo-white.svg" style="width: 200px;"></a>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, Quansight Labs
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/Quansight-Labs/ndindex" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ndindex</a><ul>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#experimental-cythonization">Experimental Cythonization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#testing-and-correctness">Testing and correctness</a></li>
<li><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS"}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>